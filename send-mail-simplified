import smtplib
import ssl
from email.message import EmailMessage
import os

# ðŸ”§ CONFIGURATION â€” Fill these in once
SENDER_EMAIL = "you@gmail.com"
APP_PASSWORD = "your_app_password_here"
RECEIVER_EMAIL = "recipient@example.com"
CSV_FILE_PATH = "C:/path/to/your/file.csv"  # No wildcards
EMAIL_SUBJECT = "Here is the CSV file"
EMAIL_BODY = "Please find the attached CSV file."

def send_csv_email():
    # Create the email
    msg = EmailMessage()
    msg['From'] = SENDER_EMAIL
    msg['To'] = RECEIVER_EMAIL
    msg['Subject'] = EMAIL_SUBJECT
    msg.set_content(EMAIL_BODY)

    # Attach the CSV file
    with open(CSV_FILE_PATH, 'rb') as f:
        file_data = f.read()
        filename = os.path.basename(CSV_FILE_PATH)
    msg.add_attachment(file_data, maintype='text', subtype='csv', filename=filename)

    # Send via Gmail
    context = ssl.create_default_context()
    with smtplib.SMTP_SSL('smtp.gmail.com', 465, context=context) as smtp:
        smtp.login(SENDER_EMAIL, APP_PASSWORD)
        smtp.send_message(msg)
    print(f"âœ… Email sent to {RECEIVER_EMAIL} with {filename} attached.")

if __name__ == "__main__":
    send_csv_email()
